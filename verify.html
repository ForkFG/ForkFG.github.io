<!DOCTYPE html>
<html lang='zh-cn'>
	<head>
		<meta http-equiv='Content-Type' content='text/html' charset='UTF-8'/>
		<title>Mushouse - Verify</title>
		<link rel='stylesheet' type='text/css' href='https://icelava.ga/style.css'>
		<link rel='stylesheet' type='text/css' href='https://icelava.ga/fa/css/font-awesome.min.css'>
		<script type='text/javascript' src='https://icelava.ga/main.js'></script>
		<script type='text/javascript' src='https://icelava.ga/marked.min.js'></script>
		<script type='text/javascript' async src='https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
		<script type='text/javascript' src='./config.js'></script>
	</head>
	<body onload='init();'>
		<div id='guide'></div>
		<p id='pos'>Verify your e-mail</p>
		<div id='main'>
			<div class='md' data-name='verify'>
				<p class='title'>
					<i class='fa fa-spinner fa-spin'></i> 页面内容正在加载中，请稍等！
				</p>
			</div> <br>
			<form method='post' action='http://loli.icelava.ga/verify.php?op=check'>
					<p class='text no-gap center'>
						<i class='fa fa-fw fa-shield'></i>
						<input type='text' name='ve' placeholder='验证码' spellcheck='false'>
						<br>

						<span id='btn_req' class='button' onclick='req_send_ve()'>获取验证码</span>
						<br>

						<input type='submit' value='Submit'>
					</p>
			</form>
		</div>
	</body>							
	<script type='text/javascript'>
		log(debug);
		function req_send_ve()
		{
			E("btn_req").innerHTML = "正在发送中 <i class='fa fa-spinner fa-spin'></i>";

			AJAX("GET", debug ? "http://localhost:8080/verify.php?op=send" : "http://loli.icelava.ga/verify.php?op=send",
			     "application/x-www-form-urlencoded", null,
			     function(XHR)
			     {
			     	// Debug: log(XHR.responseText);
			     	let $btn = E("btn_req");
			     	$btn.innerHTML = "验证码已发送";
			     	$btn.onclick = NF;
			     	let $t_msg = document.createElement("p");
			     	$t_msg.className = "text";
			     	$t_msg.innerHTML = XHR.responseText.split("<!-- PHP echo begin -->")[1].split("<!-- PHP echo end -->")[0];
			     	document.getElementsByClassName("md")[0].appendChild($t_msg)
					$t_msg.appendChild(document.createElement("hr"));
			     });
		}
	</script>
</html>
